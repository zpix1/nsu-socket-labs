var _=Object.defineProperty;var j=Object.getOwnPropertySymbols;var D=Object.prototype.hasOwnProperty,C=Object.prototype.propertyIsEnumerable;var k=(n,e,r)=>e in n?_(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,L=(n,e)=>{for(var r in e||(e={}))D.call(e,r)&&k(n,r,e[r]);if(j)for(var r of j(e))C.call(e,r)&&k(n,r,e[r]);return n};import{r as d,B as b,d as W,a as B,s as u,f,b as F,m as p,c as O,t as $,e as v,g as w,o as A,h as y,i as m,j as K,k as q,l as N,R as H,n as Y}from"./vendor.5b96542d.js";const G=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))a(t);new MutationObserver(t=>{for(const s of t)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function r(t){const s={};return t.integrity&&(s.integrity=t.integrity),t.referrerpolicy&&(s.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?s.credentials="include":t.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(t){if(t.ep)return;t.ep=!0;const s=r(t);fetch(t.href,s)}};G();const Q="0875266e-e97d-4271-8c05-c0429e6e3355",R="5ae2e3f221c38a28845f05b636b6fd4de4c4cc70484a64f28bd851e2",U="af633a14d22f0bd0ef1aa7dbbf25c580",z=(n,e)=>{d.exports.useEffect(()=>{const r=n.subscribe(a=>e(a));return()=>r.unsubscribe()},[])},E=(n,e,r)=>{const[a,t]=d.exports.useState(null),[s,o]=d.exports.useState(!1),[l,g]=d.exports.useState(null);return d.exports.useEffect(()=>{e.next(n)},[n]),z(r,({data:S,status:x,error:P})=>{x==="ok"&&S?(t(S),g(null),o(!1)):x==="loading"?(o(!0),g(null)):x==="error"&&P&&(g(P),o(!1))}),[a,s,l]},I=new b(""),V=I.pipe(W(200),B(),u(n=>n.length>1?f(`https://graphhopper.com/api/1/geocode?q=${n}&locale=ru&debug=true&key=${Q}&limit=100`).pipe(u(e=>{if(e.ok)return e.json();throw new Error(e.statusText)}),u(e=>F(e.hits).pipe(p(({country:r,city:a,name:t,point:s,osm_id:o})=>L({title:[r,a,t].filter(l=>!!l).join(", "),id:o.toString()},s)),O(r=>r.title),$(),p(r=>({status:"ok",data:r})))),v({status:"loading"}),w(async e=>({status:"error",error:e}))):A({status:"ok",data:[]}))),X=({query:n,children:e})=>{const[r,a,t]=E(n,I,V);return e(r,a,t)},M=new b(null),Z=M.pipe(y(n=>!!n),u(n=>f(`https://api.opentripmap.com/0.1/ru/places/radius?radius=1000&lon=${n.lng}&lat=${n.lat}&apikey=${R}`).pipe(m(e=>{if(e.ok)return e.json();throw new Error(e.statusText)}),m(e=>A(e.features).pipe(K(),q(4),m(r=>f(`https://api.opentripmap.com/0.1/ru/places/xid/${r.properties.xid}?apikey=${R}`).pipe(u(a=>{if(a.ok)return a.json();throw new Error(a.statusText)}),p(a=>{var t,s;return{id:a.xid,name:a.name,imageSrc:(t=a.preview)==null?void 0:t.source,description:(s=a.wikipedia_extracts)==null?void 0:s.text}}),y(a=>!!a.name))),O(r=>r.name),$())),p(e=>({status:"ok",data:e})),w(async e=>({status:"error",error:e})),v({status:"loading"})))),J=({place:n,children:e})=>{const[r,a,t]=E(n,M,Z);return e(r,a,t)},T=new b(null),ee=T.pipe(y(n=>!!n),u(n=>f(`https://api.openweathermap.org/data/2.5/weather?lat=${n.lng}&lon=${n.lat}&appid=${U}`).pipe(m(e=>{if(e.ok)return e.json();throw new Error(e.statusText)}),p(e=>({description:`${Math.floor(e.main.temp-273)} \xB0C`,iconSrc:`https://openweathermap.org/img/wn/${e.weather[0].icon}@4x.png`})),p(e=>({status:"ok",data:e})),w(async e=>({status:"error",error:e})),v({status:"loading"})))),te=({place:n,children:e})=>{const[r,a,t]=E(n,T,ee);return e(r,a,t)},i=N.exports.jsx,c=N.exports.jsxs,h=N.exports.Fragment,re=()=>{const[n,e]=d.exports.useState(""),[r,a]=d.exports.useState(null);return c("div",{className:"text-center max-w-6xl mx-auto mt-5 p-2",children:[i("div",{className:"text-3xl",children:"Place Info Getter"}),i("input",{className:"outline-none rounded p-1 mt-3",type:"text",value:n,onChange:t=>{a(null),e(t.target.value)},placeholder:"Enter address"}),i("div",{className:"mt-3",children:c("div",{className:"grid grid-cols-12 gap-2",children:[i("div",{className:"rounded col-span-4 bg-white flex flex-col gap-2 p-2",children:n&&c(h,{children:[i("div",{className:"font-bold",children:"Select a place"}),i(X,{query:n,children:(t,s,o)=>s?i("div",{children:"Loading..."}):o?i("div",{children:o.toString()}):i(h,{children:t==null?void 0:t.map(l=>i("div",{className:`border rounded text-left p-2 hover:bg-gray-100 cursor-pointer ${(r==null?void 0:r.id)===l.id&&"bg-gray-200"}`,onClick:()=>a(l),children:l.title},l.id))})})]})}),i("div",{className:"rounded col-span-5 bg-white flex flex-col gap-2 p-2",children:r&&c(h,{children:[i("div",{className:"font-bold",children:"What to see here"}),i(J,{place:r,children:(t,s,o)=>o?i("div",{children:o.toString()}):s?i("div",{children:"Loading..."}):t?t.length==0?i("div",{children:"Nothing found"}):c(h,{children:[c("div",{children:["Top ",t.length," spot",t.length==1?"":"s",": "]}),t.map(l=>c("div",{className:"border rounded flex justify-between text-left p-3 gap-2",children:[c("div",{className:"",children:[i("h2",{className:"mb-1 font-bold",children:l.name}),i("p",{className:"text-gray-600 text-sm",children:l.description})]}),l.imageSrc&&i("img",{src:l.imageSrc,className:"h-20 rounded"})]},l.id))]}):i("div",{children:"Enter something"})})]})}),i("div",{className:"rounded col-span-3 bg-white flex flex-col gap-2 p-2",children:r&&c(h,{children:[i("div",{className:"font-bold",children:"Weather"}),i(te,{place:r,children:(t,s,o)=>o?i("div",{children:o.toString()}):s?i("div",{children:"Loading..."}):t?c("div",{className:"flex-col justify-center",children:[t.description,i("img",{className:"mx-auto",src:t.iconSrc})]}):i("div",{children:"Enter something"})})]})})]})})]})};H.render(i(Y.StrictMode,{children:i(re,{})}),document.getElementById("root"));
