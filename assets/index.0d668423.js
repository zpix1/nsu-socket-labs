var _=Object.defineProperty;var j=Object.getOwnPropertySymbols;var D=Object.prototype.hasOwnProperty,C=Object.prototype.propertyIsEnumerable;var k=(n,e,r)=>e in n?_(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,L=(n,e)=>{for(var r in e||(e={}))D.call(e,r)&&k(n,r,e[r]);if(j)for(var r of j(e))C.call(e,r)&&k(n,r,e[r]);return n};import{r as d,B as x,d as W,a as B,s as u,f,b as F,m as p,c as O,t as $,e as b,g as v,o as A,h as w,i as h,j as K,k as q,l as y,R as H,n as Y}from"./vendor.5b96542d.js";const G=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))i(t);new MutationObserver(t=>{for(const s of t)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function r(t){const s={};return t.integrity&&(s.integrity=t.integrity),t.referrerpolicy&&(s.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?s.credentials="include":t.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(t){if(t.ep)return;t.ep=!0;const s=r(t);fetch(t.href,s)}};G();const Q="0875266e-e97d-4271-8c05-c0429e6e3355",R="5ae2e3f221c38a28845f05b636b6fd4de4c4cc70484a64f28bd851e2",U="af633a14d22f0bd0ef1aa7dbbf25c580",z=(n,e)=>{d.exports.useEffect(()=>{const r=n.subscribe(i=>e(i));return()=>r.unsubscribe()},[])},N=(n,e,r)=>{const[i,t]=d.exports.useState(null),[s,o]=d.exports.useState(!1),[l,m]=d.exports.useState(null);return d.exports.useEffect(()=>{e.next(n)},[n]),z(r,({data:S,status:g,error:P})=>{g==="ok"&&S?(t(S),m(null),o(!1)):g==="loading"?(o(!0),m(null)):g==="error"&&P&&(m(P),o(!1))}),[i,s,l]},I=new x(""),V=I.pipe(W(200),B(),u(n=>n.length>1?f(`https://graphhopper.com/api/1/geocode?q=${n}&locale=ru&debug=true&key=${Q}&limit=100`).pipe(u(e=>{if(e.ok)return e.json();throw new Error(e.statusText)}),u(e=>F(e.hits).pipe(p(({country:r,city:i,name:t,point:s,osm_id:o})=>L({title:[r,i,t].filter(l=>!!l).join(", "),id:o.toString()},s)),O(r=>r.title),$(),p(r=>({status:"ok",data:r})))),b({status:"loading"}),v(async e=>({status:"error",error:e}))):A({status:"ok",data:[]}))),X=({query:n,children:e})=>{const[r,i,t]=N(n,I,V);return e(r,i,t)},M=new x(null),Z=M.pipe(w(n=>!!n),u(n=>f(`https://api.opentripmap.com/0.1/ru/places/radius?radius=1000&lon=${n.lng}&lat=${n.lat}&apikey=${R}`).pipe(h(e=>{if(e.ok)return e.json();throw new Error(e.statusText)}),h(e=>A(e.features).pipe(K(),q(4),h(r=>f(`http://api.opentripmap.com/0.1/ru/places/xid/${r.properties.xid}?apikey=${R}`).pipe(u(i=>{if(i.ok)return i.json();throw new Error(i.statusText)}),p(i=>{var t,s;return{id:i.xid,name:i.name,imageSrc:(t=i.preview)==null?void 0:t.source,description:(s=i.wikipedia_extracts)==null?void 0:s.text}}),w(i=>!!i.name))),O(r=>r.name),$())),p(e=>({status:"ok",data:e})),v(async e=>({status:"error",error:e})),b({status:"loading"})))),J=({place:n,children:e})=>{const[r,i,t]=N(n,M,Z);return e(r,i,t)},T=new x(null),ee=T.pipe(w(n=>!!n),u(n=>f(`https://api.openweathermap.org/data/2.5/weather?lat=${n.lng}&lon=${n.lat}&appid=${U}`).pipe(h(e=>{if(e.ok)return e.json();throw new Error(e.statusText)}),p(e=>({description:`${Math.floor(e.main.temp-273)} \xB0C`,iconSrc:`http://openweathermap.org/img/wn/${e.weather[0].icon}@4x.png`})),p(e=>({status:"ok",data:e})),v(async e=>({status:"error",error:e})),b({status:"loading"})))),te=({place:n,children:e})=>{const[r,i,t]=N(n,T,ee);return e(r,i,t)},a=y.exports.jsx,c=y.exports.jsxs,E=y.exports.Fragment,re=()=>{const[n,e]=d.exports.useState(""),[r,i]=d.exports.useState(null);return c("div",{className:"text-center max-w-6xl mx-auto mt-5 p-2",children:[a("div",{className:"text-3xl",children:"Place Info Getter"}),a("input",{className:"outline-none rounded p-1 mt-3",type:"text",value:n,onChange:t=>{i(null),e(t.target.value)},placeholder:"Enter address"}),a("div",{className:"mt-3",children:c("div",{className:"grid grid-cols-12 gap-2",children:[a("div",{className:"rounded col-span-4 bg-white flex flex-col gap-2 p-2",children:a(X,{query:n,children:(t,s,o)=>s?a("div",{children:"Loading..."}):o?a("div",{children:o.toString()}):a(E,{children:t==null?void 0:t.map(l=>a("div",{className:`border rounded text-left p-2 hover:bg-gray-100 cursor-pointer ${(r==null?void 0:r.id)===l.id&&"bg-gray-200"}`,onClick:()=>i(l),children:l.title},l.id))})})}),a("div",{className:"rounded col-span-5 bg-white flex flex-col gap-2 p-2",children:r&&c(E,{children:[a("div",{className:"font-bold",children:"What to see here"}),a(J,{place:r,children:(t,s,o)=>o?a("div",{children:o.toString()}):s?a("div",{children:"Loading..."}):t?t.length==0?a("div",{children:"Nothing found"}):c(E,{children:[c("div",{children:["Top ",t.length," spot",t.length==1?"":"s",": "]}),t.map(l=>c("div",{className:"border rounded flex justify-between text-left p-3 gap-2",children:[c("div",{className:"",children:[a("h2",{className:"mb-1 font-bold",children:l.name}),a("p",{className:"text-gray-600 text-sm",children:l.description})]}),l.imageSrc&&a("img",{src:l.imageSrc,className:"h-20 rounded"})]},l.id))]}):a("div",{children:"Enter something"})})]})}),c("div",{className:"rounded col-span-3 bg-white flex flex-col gap-2 p-2",children:[a("div",{className:"font-bold",children:"Weather"}),r&&a(te,{place:r,children:(t,s,o)=>o?a("div",{children:o.toString()}):s?a("div",{children:"Loading..."}):t?c("div",{className:"flex-col justify-center",children:[t.description,a("img",{className:"mx-auto",src:t.iconSrc})]}):a("div",{children:"Enter something"})})]})]})})]})};H.render(a(Y.StrictMode,{children:a(re,{})}),document.getElementById("root"));
